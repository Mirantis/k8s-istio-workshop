<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Istio - Installation | Istio Workshop</title>
    <meta name="description" content="Istio workshop running on OpenStack">
    <link rel="icon" href="/k8s-istio-workshop/favicon.ico">
    <meta property="article:modified_time" content="2019-03-07T10:38:36.000Z"><meta property="og:site_name" content="Istio Workshop"><meta property="og:title" content="Istio - Installation"><meta property="og:type" content="website"><meta property="og:url" content="/lab-06/"><meta name="twitter:title" content="Istio - Installation"><meta name="twitter:url" content="/lab-06/"><meta name="twitter:card" content="summary_large_image">
    <link rel="preload" href="/k8s-istio-workshop/assets/css/0.styles.2dcdd8f4.css" as="style"><link rel="preload" href="/k8s-istio-workshop/assets/js/app.c242fc30.js" as="script"><link rel="preload" href="/k8s-istio-workshop/assets/js/2.93ef1c11.js" as="script"><link rel="preload" href="/k8s-istio-workshop/assets/js/14.1d353182.js" as="script"><link rel="prefetch" href="/k8s-istio-workshop/assets/js/10.b47dd514.js"><link rel="prefetch" href="/k8s-istio-workshop/assets/js/11.f507860f.js"><link rel="prefetch" href="/k8s-istio-workshop/assets/js/12.860113ac.js"><link rel="prefetch" href="/k8s-istio-workshop/assets/js/13.32857c17.js"><link rel="prefetch" href="/k8s-istio-workshop/assets/js/15.85b664cc.js"><link rel="prefetch" href="/k8s-istio-workshop/assets/js/16.01747397.js"><link rel="prefetch" href="/k8s-istio-workshop/assets/js/17.8731e2f4.js"><link rel="prefetch" href="/k8s-istio-workshop/assets/js/18.65b244ff.js"><link rel="prefetch" href="/k8s-istio-workshop/assets/js/3.b91652f2.js"><link rel="prefetch" href="/k8s-istio-workshop/assets/js/4.4b811129.js"><link rel="prefetch" href="/k8s-istio-workshop/assets/js/5.3afcd348.js"><link rel="prefetch" href="/k8s-istio-workshop/assets/js/6.79416558.js"><link rel="prefetch" href="/k8s-istio-workshop/assets/js/7.ecfd21e8.js"><link rel="prefetch" href="/k8s-istio-workshop/assets/js/8.0b72bd57.js"><link rel="prefetch" href="/k8s-istio-workshop/assets/js/9.92913571.js">
    <link rel="stylesheet" href="/k8s-istio-workshop/assets/css/0.styles.2dcdd8f4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/k8s-istio-workshop/" class="home-link router-link-active"><img src="/k8s-istio-workshop/istio.svg" alt="Istio Workshop" class="logo"> <span class="site-name can-hide">Istio Workshop</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/k8s-istio-workshop/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Istio links</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://istio.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Istio
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://istio.io/docs/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Istio docs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/mirantis/k8s-istio-workshop" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Istio workshop
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/ruzickap/k8s-istio-demo" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Istio demo
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <a href="https://github.com/mirantis/k8s-istio-workshop" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/k8s-istio-workshop/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Istio links</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://istio.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Istio
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://istio.io/docs/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Istio docs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/mirantis/k8s-istio-workshop" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Istio workshop
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/ruzickap/k8s-istio-demo" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Istio demo
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <a href="https://github.com/mirantis/k8s-istio-workshop" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/k8s-istio-workshop/" class="sidebar-link">Istio workshop</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/k8s-istio-workshop/#requirements" class="sidebar-link">Requirements</a></li><li class="sidebar-sub-header"><a href="/k8s-istio-workshop/#objectives" class="sidebar-link">Objectives</a></li><li class="sidebar-sub-header"><a href="/k8s-istio-workshop/#workshop" class="sidebar-link">Workshop</a></li><li class="sidebar-sub-header"><a href="/k8s-istio-workshop/#list-of-guis-used-in-workshop" class="sidebar-link">List of GUIs used in Workshop</a></li><li class="sidebar-sub-header"><a href="/k8s-istio-workshop/#links" class="sidebar-link">Links</a></li></ul></li><li><a href="/k8s-istio-workshop/lab-01/" class="sidebar-link">Create VMs in OpenStack</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/k8s-istio-workshop/lab-01/#prepare-the-local-working-environment-inside-docker" class="sidebar-link">Prepare the local working environment inside Docker</a></li><li class="sidebar-sub-header"><a href="/k8s-istio-workshop/lab-01/#provision-vms-in-openstack" class="sidebar-link">Provision VMs in OpenStack</a></li></ul></li><li><a href="/k8s-istio-workshop/lab-02/" class="sidebar-link">Install Kubernetes to the VMs</a></li><li><a href="/k8s-istio-workshop/lab-03/" class="sidebar-link">Install Helm</a></li><li><a href="/k8s-istio-workshop/lab-04/" class="sidebar-link">Instal Rook</a></li><li><a href="/k8s-istio-workshop/lab-05/" class="sidebar-link">Install ElasticSearch and Kibana</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/k8s-istio-workshop/lab-05/#install-fluentbit" class="sidebar-link">Install FluentBit</a></li></ul></li><li><a href="/k8s-istio-workshop/lab-06/" class="active sidebar-link">Istio - Installation</a></li><li><a href="/k8s-istio-workshop/lab-07/" class="sidebar-link">Istio - Bookinfo Application</a></li><li><a href="/k8s-istio-workshop/lab-08/" class="sidebar-link">Istio - Configuring Request Routing</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/k8s-istio-workshop/lab-08/#apply-a-virtual-service" class="sidebar-link">Apply a virtual service</a></li><li class="sidebar-sub-header"><a href="/k8s-istio-workshop/lab-08/#route-based-on-user-identity" class="sidebar-link">Route based on user identity</a></li></ul></li><li><a href="/k8s-istio-workshop/lab-09/" class="sidebar-link">Istio - Injecting an HTTP delay fault</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/k8s-istio-workshop/lab-09/#injecting-an-http-abort-fault" class="sidebar-link">Injecting an HTTP abort fault</a></li></ul></li><li><a href="/k8s-istio-workshop/lab-10/" class="sidebar-link">Istio - Weight-based routing</a></li><li><a href="/k8s-istio-workshop/lab-11/" class="sidebar-link">Istio - Mirroring</a></li><li><a href="/k8s-istio-workshop/lab-12/" class="sidebar-link">Istio - Cleanup</a></li></ul> </aside> <main class="page"> <div class="content default"><h1 id="istio-installation"><a href="#istio-installation" aria-hidden="true" class="header-anchor">#</a> Istio - Installation</h1> <div class="tip custom-block"><p class="custom-block-title">TIP</p> <p>Screencast: <a href="https://asciinema.org/a/229605?autoplay=0&amp;t=275" target="_blank" rel="noopener noreferrer">https://asciinema.org/a/229605?t=275<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <p>Istio architectue</p> <p><img src="https://raw.githubusercontent.com/istio/istio.io/7bf371365e4a16a9a13c0e79355fe1eac7f8f99f/content/docs/concepts/what-is-istio/arch.svg?sanitize=true" alt="Istio Architecture" title="Istio Architecture"></p> <p>Either download Istio directly from <a href="https://github.com/istio/istio/releases" target="_blank" rel="noopener noreferrer">https://github.com/istio/istio/releases<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
or get the latest version by using curl:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">export</span> ISTIO_VERSION<span class="token operator">=</span><span class="token string">&quot;1.0.6&quot;</span>
<span class="token function">test</span> -d tmp <span class="token operator">||</span> <span class="token function">mkdir</span> tmp
<span class="token function">cd</span> tmp
<span class="token function">curl</span> -sL https://git.io/getLatestIstio <span class="token operator">|</span> sh -
</code></pre></div><p>Change the directory to the Istio installation files location:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">cd</span> istio*
</code></pre></div><p>Install <code>istioctl</code>:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">mv</span> bin/istioctl /usr/local/bin/
</code></pre></div><p>Define the credentials you want to use as the Kiali username and passphrase (admin/admin):</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">export</span> KIALI_USERNAME<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token keyword">echo</span> -n <span class="token string">&quot;admin&quot;</span> <span class="token operator">|</span> base64<span class="token variable">)</span></span>
<span class="token function">export</span> KIALI_PASSPHRASE<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token keyword">echo</span> -n <span class="token string">&quot;admin&quot;</span> <span class="token operator">|</span> base64<span class="token variable">)</span></span>
</code></pre></div><p>Create the namespace and secret:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>NAMESPACE<span class="token operator">=</span>istio-system
kubectl create namespace <span class="token variable">$NAMESPACE</span>

<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> EOF <span class="token operator">|</span> kubectl apply -f -
apiVersion: v1
kind: Secret
metadata:
  name: kiali
  namespace: <span class="token variable">$NAMESPACE</span>
  labels:
    app: kiali
type: Opaque
data:
  username: <span class="token variable">$KIALI_USERNAME</span>
  passphrase: <span class="token variable">$KIALI_PASSPHRASE</span>
EOF
</code></pre></div><p>Install <a href="https://istio.io/" target="_blank" rel="noopener noreferrer">Istio<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> using Helm:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>helm <span class="token function">install</span> --wait --name istio --namespace istio-system install/kubernetes/helm/istio \
  --set gateways.istio-ingressgateway.type<span class="token operator">=</span>NodePort \
  --set gateways.istio-egressgateway.type<span class="token operator">=</span>NodePort \
  --set grafana.enabled<span class="token operator">=</span>true \
  --set kiali.enabled<span class="token operator">=</span>true \
  --set kiali.dashboard.grafanaURL<span class="token operator">=</span>http://localhost:3000 \
  --set kiali.dashboard.jaegerURL<span class="token operator">=</span>http://localhost:16686 \
  --set servicegraph.enabled<span class="token operator">=</span>true \
  --set telemetry-gateway.grafanaEnabled<span class="token operator">=</span>true \
  --set telemetry-gateway.prometheusEnabled<span class="token operator">=</span>true \
  --set tracing.enabled<span class="token operator">=</span>true
</code></pre></div><p>See the Istio components:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl get --namespace<span class="token operator">=</span>istio-system svc,deployment,pods -o wide
</code></pre></div><p>Output:</p> <div class="language-shell extra-class"><pre class="language-shell"><code>NAME                             TYPE        CLUSTER-IP       EXTERNAL-IP   PORT<span class="token punctuation">(</span>S<span class="token punctuation">)</span>                                                                                                                   AGE   SELECTOR
service/grafana                  ClusterIP   10.101.117.126   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        3000/TCP                                                                                                                  15m   app<span class="token operator">=</span>grafana
service/istio-citadel            ClusterIP   10.99.235.151    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        8060/TCP,9093/TCP                                                                                                         15m   istio<span class="token operator">=</span>citadel
service/istio-egressgateway      NodePort    10.105.213.174   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        80:31610/TCP,443:31811/TCP                                                                                                15m   app<span class="token operator">=</span>istio-egressgateway,istio<span class="token operator">=</span>egressgateway
service/istio-galley             ClusterIP   10.110.154.0     <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        443/TCP,9093/TCP                                                                                                          15m   istio<span class="token operator">=</span>galley
service/istio-ingressgateway     NodePort    10.101.212.170   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        80:31380/TCP,443:31390/TCP,31400:31400/TCP,15011:31814/TCP,8060:31435/TCP,853:31471/TCP,15030:30210/TCP,15031:30498/TCP   15m   app<span class="token operator">=</span>istio-ingressgateway,istio<span class="token operator">=</span>ingressgateway
service/istio-pilot              ClusterIP   10.96.34.157     <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        15010/TCP,15011/TCP,8080/TCP,9093/TCP                                                                                     15m   istio<span class="token operator">=</span>pilot
service/istio-policy             ClusterIP   10.98.185.215    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        9091/TCP,15004/TCP,9093/TCP                                                                                               15m   istio-mixer-type<span class="token operator">=</span>policy,istio<span class="token operator">=</span>mixer
service/istio-sidecar-injector   ClusterIP   10.97.47.179     <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        443/TCP                                                                                                                   15m   istio<span class="token operator">=</span>sidecar-injector
service/istio-telemetry          ClusterIP   10.103.23.55     <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        9091/TCP,15004/TCP,9093/TCP,42422/TCP                                                                                     15m   istio-mixer-type<span class="token operator">=</span>telemetry,istio<span class="token operator">=</span>mixer
service/jaeger-agent             ClusterIP   None             <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        5775/UDP,6831/UDP,6832/UDP                                                                                                15m   app<span class="token operator">=</span>jaeger
service/jaeger-collector         ClusterIP   10.110.10.174    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        14267/TCP,14268/TCP                                                                                                       15m   app<span class="token operator">=</span>jaeger
service/jaeger-query             ClusterIP   10.98.172.235    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        16686/TCP                                                                                                                 15m   app<span class="token operator">=</span>jaeger
service/kiali                    ClusterIP   10.111.114.225   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        20001/TCP                                                                                                                 15m   app<span class="token operator">=</span>kiali
service/prometheus               ClusterIP   10.111.132.151   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        9090/TCP                                                                                                                  15m   app<span class="token operator">=</span>prometheus
service/servicegraph             ClusterIP   10.109.59.250    <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        8088/TCP                                                                                                                  15m   app<span class="token operator">=</span>servicegraph
service/tracing                  ClusterIP   10.96.59.251     <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        80/TCP                                                                                                                    15m   app<span class="token operator">=</span>jaeger
service/zipkin                   ClusterIP   10.107.168.128   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>        9411/TCP                                                                                                                  15m   app<span class="token operator">=</span>jaeger

NAME                                           READY   UP-TO-DATE   AVAILABLE   AGE   CONTAINERS                 IMAGES                                                      SELECTOR
deployment.extensions/grafana                  1/1     1            1           15m   grafana                    grafana/grafana:5.2.3                                       app<span class="token operator">=</span>grafana
deployment.extensions/istio-citadel            1/1     1            1           15m   citadel                    docker.io/istio/citadel:1.0.5                               istio<span class="token operator">=</span>citadel
deployment.extensions/istio-egressgateway      1/1     1            1           15m   istio-proxy                docker.io/istio/proxyv2:1.0.5                               app<span class="token operator">=</span>istio-egressgateway,istio<span class="token operator">=</span>egressgateway
deployment.extensions/istio-galley             1/1     1            1           15m   validator                  docker.io/istio/galley:1.0.5                                istio<span class="token operator">=</span>galley
deployment.extensions/istio-ingressgateway     1/1     1            1           15m   istio-proxy                docker.io/istio/proxyv2:1.0.5                               app<span class="token operator">=</span>istio-ingressgateway,istio<span class="token operator">=</span>ingressgateway
deployment.extensions/istio-pilot              1/1     1            1           15m   discovery,istio-proxy      docker.io/istio/pilot:1.0.5,docker.io/istio/proxyv2:1.0.5   app<span class="token operator">=</span>pilot,istio<span class="token operator">=</span>pilot
deployment.extensions/istio-policy             1/1     1            1           15m   mixer,istio-proxy          docker.io/istio/mixer:1.0.5,docker.io/istio/proxyv2:1.0.5   app<span class="token operator">=</span>policy,istio<span class="token operator">=</span>mixer,istio-mixer-type<span class="token operator">=</span>policy
deployment.extensions/istio-sidecar-injector   1/1     1            1           15m   sidecar-injector-webhook   docker.io/istio/sidecar_injector:1.0.5                      istio<span class="token operator">=</span>sidecar-injector
deployment.extensions/istio-telemetry          1/1     1            1           15m   mixer,istio-proxy          docker.io/istio/mixer:1.0.5,docker.io/istio/proxyv2:1.0.5   app<span class="token operator">=</span>telemetry,istio<span class="token operator">=</span>mixer,istio-mixer-type<span class="token operator">=</span>telemetry
deployment.extensions/istio-tracing            1/1     1            1           15m   jaeger                     docker.io/jaegertracing/all-in-one:1.5                      app<span class="token operator">=</span>jaeger
deployment.extensions/kiali                    1/1     1            1           15m   kiali                      docker.io/kiali/kiali:v0.10                                 app<span class="token operator">=</span>kiali
deployment.extensions/prometheus               1/1     1            1           15m   prometheus                 docker.io/prom/prometheus:v2.3.1                            app<span class="token operator">=</span>prometheus
deployment.extensions/servicegraph             1/1     1            1           15m   servicegraph               docker.io/istio/servicegraph:1.0.5                          app<span class="token operator">=</span>servicegraph

NAME                                          READY   STATUS      RESTARTS   AGE   IP            NODE                             NOMINATED NODE   READINESS GATES
pod/grafana-59b8896965-pmwd2                  1/1     Running     0          15m   10.244.1.16   pruzicka-k8s-istio-workshop-node03   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
pod/istio-citadel-856f994c58-8r8nr            1/1     Running     0          15m   10.244.1.17   pruzicka-k8s-istio-workshop-node03   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
pod/istio-egressgateway-5649fcf57-sv8wf       1/1     Running     0          15m   10.244.1.14   pruzicka-k8s-istio-workshop-node03   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
pod/istio-galley-7665f65c9c-8sjmm             1/1     Running     0          15m   10.244.1.18   pruzicka-k8s-istio-workshop-node03   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
pod/istio-grafana-post-install-kw74d          0/1     Completed   0          10m   10.244.1.19   pruzicka-k8s-istio-workshop-node03   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
pod/istio-ingressgateway-6755b9bbf6-f7pnx     1/1     Running     0          15m   10.244.1.13   pruzicka-k8s-istio-workshop-node03   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
pod/istio-pilot-56855d999b-6zq86              2/2     Running     0          15m   10.244.0.11   pruzicka-k8s-istio-workshop-node01   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
pod/istio-policy-6fcb6d655f-4zndw             2/2     Running     0          15m   10.244.2.13   pruzicka-k8s-istio-workshop-node02   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
pod/istio-sidecar-injector-768c79f7bf-74wbc   1/1     Running     0          15m   10.244.2.18   pruzicka-k8s-istio-workshop-node02   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
pod/istio-telemetry-664d896cf5-smz7w          2/2     Running     0          15m   10.244.2.14   pruzicka-k8s-istio-workshop-node02   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
pod/istio-tracing-6b994895fd-vb58q            1/1     Running     0          15m   10.244.2.17   pruzicka-k8s-istio-workshop-node02   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
pod/kiali-67c69889b5-sw92h                    1/1     Running     0          15m   10.244.1.15   pruzicka-k8s-istio-workshop-node03   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
pod/prometheus-76b7745b64-kwzj5               1/1     Running     0          15m   10.244.2.15   pruzicka-k8s-istio-workshop-node02   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
pod/servicegraph-5c4485945b-j9bp2             1/1     Running     0          15m   10.244.2.16   pruzicka-k8s-istio-workshop-node02   <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>           <span class="token operator">&lt;</span>none<span class="token operator">&gt;</span>
</code></pre></div><p>Configure Istio with a new log type and send those logs to the FluentD:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl apply -f <span class="token punctuation">..</span>/<span class="token punctuation">..</span>/files/fluentd-istio.yaml
</code></pre></div><p>Check + Enable Istio in default namespace.</p> <p>Allow the <code>default</code> namespace to use Istio injection:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl label namespace default istio-injection<span class="token operator">=</span>enabled
</code></pre></div><p>Check namespaces:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl get namespace -L istio-injection
</code></pre></div><p>Output:</p> <div class="language-shell extra-class"><pre class="language-shell"><code>NAME               STATUS   AGE   ISTIO-INJECTION
default            Active   70m   enabled
es-operator        Active   41m
istio-system       Active   16m
kube-public        Active   70m
kube-system        Active   70m
logging            Active   38m
rook-ceph          Active   59m
rook-ceph-system   Active   63m
</code></pre></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p> <p>Run the following command on your local environment.</p></div> <p>Configure port forwarding to Istio services:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Jaeger - http://localhost:16686</span>
kubectl port-forward -n istio-system <span class="token variable"><span class="token variable">$(</span>kubectl get pod -n istio-system -l app<span class="token operator">=</span>jaeger -o jsonpath<span class="token operator">=</span><span class="token string">&quot;{.items[0].metadata.name}&quot;</span><span class="token variable">)</span></span> 16686:16686 <span class="token operator">&amp;</span>

<span class="token comment"># Prometheus - http://localhost:9090/graph</span>
kubectl -n istio-system port-forward <span class="token variable"><span class="token variable">$(</span>kubectl -n istio-system get pod -l app<span class="token operator">=</span>prometheus -o jsonpath<span class="token operator">=</span><span class="token string">&quot;{.items[0].metadata.name}&quot;</span><span class="token variable">)</span></span> 9090:9090 <span class="token operator">&amp;</span>

<span class="token comment"># Grafana - http://localhost:3000/dashboard/db/istio-mesh-dashboard</span>
kubectl -n istio-system port-forward <span class="token variable"><span class="token variable">$(</span>kubectl -n istio-system get pod -l app<span class="token operator">=</span>grafana -o jsonpath<span class="token operator">=</span><span class="token string">&quot;{.items[0].metadata.name}&quot;</span><span class="token variable">)</span></span> 3000:3000 <span class="token operator">&amp;</span>

<span class="token comment"># Kiali - http://localhost:20001</span>
kubectl -n istio-system port-forward <span class="token variable"><span class="token variable">$(</span>kubectl -n istio-system get pod -l app<span class="token operator">=</span>kiali -o jsonpath<span class="token operator">=</span><span class="token string">&quot;{.items[0].metadata.name}&quot;</span><span class="token variable">)</span></span> 20001:20001 <span class="token operator">&amp;</span>

<span class="token comment"># Servicegraph - http://localhost:8088/force/forcegraph.html</span>
kubectl -n istio-system port-forward <span class="token variable"><span class="token variable">$(</span>kubectl -n istio-system get pod -l app<span class="token operator">=</span>servicegraph -o jsonpath<span class="token operator">=</span><span class="token string">&quot;{.items[0].metadata.name}&quot;</span><span class="token variable">)</span></span> 8088:8088 <span class="token operator">&amp;</span>
</code></pre></div><p><img src="/k8s-istio-workshop/assets/img/istio.a24267ed.svg" alt="Istio" title="Istio"></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/mirantis/k8s-istio-workshop/edit/master/docs/lab-06/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">3/7/2019, 10:38:36 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/k8s-istio-workshop/lab-05/" class="prev">
          Install ElasticSearch and Kibana
        </a></span> <span class="next"><a href="/k8s-istio-workshop/lab-07/">
          Istio - Bookinfo Application
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/k8s-istio-workshop/assets/js/app.c242fc30.js" defer></script><script src="/k8s-istio-workshop/assets/js/2.93ef1c11.js" defer></script><script src="/k8s-istio-workshop/assets/js/14.1d353182.js" defer></script>
  </body>
</html>
